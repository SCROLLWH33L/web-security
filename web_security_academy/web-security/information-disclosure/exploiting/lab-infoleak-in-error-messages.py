from web_security_academy.core.utils import *
from urllib.parse import urlencode


def solve_lab(session):
    params = {"productId": "a"}
    print_info(f'Visiting "{session.url}product?{urlencode(params)}"')
    resp = session.get_path("/product", params=params)
    print_success(f"URL came back with the following text: \n{resp.text}\n")

    # Last line of response
    version = resp.text.split("\n")[-1]
    session.submit_solution(version)
